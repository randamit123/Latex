# Database Management for PaperLeaf

This guide explains how to use the designated database scripts from the `package.json` file and manage your database with Drizzle and Neon Postgres.

---

## Database Scripts

The following scripts are available in the `package.json` file to handle database operations:

### 1. Command: `npm run db:generate`
- **Script:**  
  ```bash
  drizzle-kit generate --config=drizzle.config.ts
  ```
- **What It Does:**
    This command generates the necessary migration files based on your current database schema configuration.
    Use this script after modifying your schema to ensure the migrations are up to date.

---

### 2. Command: `npm run db:migrate`
- **Script:**  
  ```bash
  tsx src/app/db/migrate.ts
  ```
- **What It Does:**
    This command runs the migration files to apply changes to your database schema.
    Use this script after running db:generate to execute the migrations on your database.

---

### 3. Command: `npm run db:push`
- **Script:**  
  ```bash
  npx drizzle-kit push
  ```
- **What It Does:**
    This command pushes your schema directly to the database, propagating your tables to the connected Neon Postgres database.
    Use this script if you are setting up a new project or need to synchronize your database with your updated schema.

---

## When to Use These Commands
1. **Connecting to a New Project or Database:**
- If you are setting up a new project or connecting to a new Neon Postgres database, use the following steps to propagate the database with the tables:
```bash
npm run db:generate
npm run db:push
```
- This ensures the database is initialized with the correct schema.
2. **Updating the Schema:**
- If you make changes to the schema, follow these steps to update the database:
```bash
npm run db:generate
npm run db:migrate
```

---

## Migrations Folder
1. **Location**
Ensure you have a folder named `latexMigrations` in your frontend directory.
- This folder is used to store migration files generated by Drizzle.
2. **Resetting the Database:**
- If you need to completely reset your database, you can:
    - Delete the contents of the `latexMigrations` folder.
    - Delete the tables directly from your Neon Postgres database.
3. **Re-Initializing the Database:**
- After resetting, run the following commands to re-initialize the database:
```bash
npm run db:generate
npm run db:push
```

---

## Important Notes
- Always back up your database before making significant changes or resetting it.
- Follow the sequence of commands carefully to ensure the database stays in sync with your schema changes.
